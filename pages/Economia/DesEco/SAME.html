<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAME</title>
    <link rel="stylesheet" href="../../../css/estilo.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <style>
        #Feriamap {
            height: 400px;
            width: 100%;
        }
        #Seguimientosmap {
            height: 400px;
            width: 100%;
        }
    </style>
  
</head>
<body>
  <div class=" justify-content-center " id="">
    <div class="row">
      <div class="nav">Hola pepe</div>
      <ul class="nav nav-tabs nav-fill">
        <li class="nav-item">
          <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
            aria-selected="true">Home</a>
        </li>


      </ul>
      <div class="col-12 col-lg-6">
      </div>
      <div class="col-12 col-lg-6">
      </div>
    </div>
  </div>
  <form action="" id="mainForm">
    <div
        class="container"
    >
       
    <div class="container " >
    <hr class="solid">
    <div class="container-md" data-sheet="Same" style="padding-bottom: 10px;">
      <input type="text" style="display: none;" id="mes" value="" >
    <h1>SAME</h1>
    <div class="row mb-5">
      <h2>Circulo de Emprendedores</h2>
     
        <div class="col-6">
          <label for="" class="form-label">Nuevos</label>
          <input type="text" class="form-control form-control-lg" name="Nuevos" id="nuevos" aria-describedby="helpId"
            placeholder="" />
          
        </div>
        <div class="col-6"> <label for="" class="form-label">Total</label>
          <input type="text" class="form-control form-control-lg" name="Total" id="total" aria-describedby="helpId"
            placeholder="" />
         
        </div>

  
     

      </div>
  </div>
  <hr class="solid">
<div
  class="container-fluid"
>
  <div
    class="row justify-content-center align-items-center g-2"
  ><h2>Entregas de Insumos</h2>
    <div class="col"><div class="mb-3">
      <label for="" class="form-label">Total Entregas</label>
      <input
        type="text"
        class="form-control form-control-lg"
        name="entegaInsumos"
        id="entegaInsumos"
        aria-describedby="helpId"
        placeholder=""
      />
    
    </div>
    </div>
    <div class="col"><div class="mb-3">
      <label for="" class="form-label">Beneficiarios</label>
      <input
        type="text"
        class="form-control form-control-lg"
        name="BeneficiariosInsumos"
        id="BeneficiariosInsumos"
        aria-describedby="helpId"
        placeholder=""
      />
     
    </div>
    </div>
 
  </div>
  
</div>

  <div class="container-md" data-sheet="Same-Ferias" style="padding-bottom: 10px;">
  <div class="col-4">
    <h2>Ferias </h2>
  </div>
  <div class="row  align-items-center g-2">
    <div class="d-grid gap-2 col-3 mx-auto agregar"> 
      <button type="button" id="Feria"
        idIndex="selectFerias" lista='["Ferias"]' indexglobal="0"
        ids='["fechaFeria","nombreFeria","coordFeria","totalFeriantes"]'  mapa="Feriamap"
        class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
         Agregar</button></div>
    <div class="d-grid gap-2 col-3 mx-auto">
      <button id="quitarParticipacion" class="btn btn-danger" type="button"><i class="fa fa-trash" aria-hidden="true"></i> Quitar</button>
    </div>

    <div class="col-6">

    </div>
  </div>



  <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
    <div class="col-3 d-flex flex-column">
      <div class="d-grid gap-2">

      </div>
      <select class="form-select flex-grow-1 mt-3" id="selectFerias" multiple aria-label=" select example">
        <!-- Opciones -->
      </select>
    </div>
    <div class="col-9"><div id="DerechaFerias" style="display: none;">
      <div
    class="row mb-5"
  >
    <div class="col-3">
      
        <label for="" class="form-label"> Fecha</label>
        <input
            type="date"
            class="form-control form-control-lg "
            name=""
            id="fechaFeria"
            aria-describedby="helpId"
            placeholder=""
        />
      
      </div>
 
    <div class="col-12 mb-3">
        <label for="" class="form-label">Nombre del evento</label>
        <input
            type="text"
            class="form-control form-control-lg"
            name=""
            id="nombreFeria"
            aria-describedby="helpId"
            placeholder=""
        />
        <label for="" class="form-label">Total Feriantes</label>
        <input
          type="text"
          class="form-control form-control-lg"
          name="totalFeriantes"
          id="totalFeriantes"
          aria-describedby="helpId"
          placeholder=""
        />
       
   
    </div>
 
      

    
    <div class="col-12">
      <div id="Feriamap" class="mapa" tipoMapa="Feria"></div>
  <label for="coordinates">Coordenadas:</label>
  <input type="text" id="coordFeria" readonly />
    </div> </div> <input type="text" class="form-control" name="FeriasFinal" id="FeriasFinal" style="display: none"
    aria-describedby="helpId" placeholder="" />
    <div class="d-grid gap-2 col-12 mx-auto"> <button type="button" idIndex="selectFerias" lista='["Ferias"]' indexglobal="0"
      ids='["fecha","fechaFeria","nombreFeria","coordFeria"]' mapa="Feria"
        class="btn btn-success guardar">
        <i class="fa-solid fa-floppy-disk"></i> Guardar
      </button></div>
  </div></div>
   
    
  </div>
</div>


  <div  data-sheet="Same-Seguimientos" style="padding-bottom: 10px;">
 
    <div class="container-md"  style="padding-bottom: 10px;">
      <div class="col-4">
        <h2>Seguimientos </h2>
      </div>
      <div class="row  align-items-center g-2">
        <div class="d-grid gap-2 col-3 mx-auto agregar"> 
          <button type="button" id="crearSeguimientos"
          idIndex="selectSeguimientos" lista='["Seguimientos"]' indexglobal="0"
          ids='["fechaSeguimientos","RubroSeguimientos","NombreSeguimientos","coordSeguimientos"]' mapa="Seguimientosmap"
          class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
           Agregar</button></div>
        <div class="d-grid gap-2 col-3 mx-auto">
          <button id="quitarParticipacion" class="btn btn-danger" type="button"><i class="fa fa-trash" aria-hidden="true"></i> Quitar</button>
        </div>
    
        <div class="col-6">
    
        </div>
      </div>    
      <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
        <div class="col-3 d-flex flex-column">
          <div class="d-grid gap-2">
    
          </div>
          <select class="form-select flex-grow-1 mt-3" id="selectSeguimientos" multiple aria-label=" select example">
            <!-- Opciones -->
          </select>
        </div>
        <div class="col-9"><div id="DerechaSeguimientos" style="display: none;">
          <div
        class="row mb-5"
      >
      <div class="mb-3">
        <label for="" class="form-label">Nombre</label>
        <input
          type="text"
          class="form-control form-control-lg"
          name="NombreSeguimientos"
          id="NombreSeguimientos"
          aria-describedby="helpId"
          placeholder=""
        />
       
      </div>
      <div class="mb-3">
        <label for="" class="form-label">Rubro</label>
        <input
          type="text"
          class="form-control form-control-lg"
          name="RubroSeguimientos"
          id="RubroSeguimientos"
          aria-describedby="helpId"
          placeholder=""
        />
       
      </div>
        <div class="col-12 mb-3">
          
            <label for="" class="form-label"> Fecha</label>
            <input
                type="date"
                class="form-control form-control-lg "
                name="fechaSeguimientos"
                id="fechaSeguimientos"
                aria-describedby="helpId"
                placeholder=""
            />
          
          </div>
     
       
          
    
        
        <div class="col-12">
          <div id="Seguimientosmap" class="mapa" tipoMapa="Seguimientos"></div>
      <label for="coordinates">Coordenadas:</label>
      <input type="text" id="coordSeguimientos" readonly />
        </div> </div> <input type="text" class="form-control" name="SeguimientosFinal" id="SeguimientosFinal" style="display: none"
        aria-describedby="helpId" placeholder="" />
        <div class="d-grid gap-2 col-12 mx-auto"> <button type="button" idIndex="selectSeguimientos" lista='["Seguimientos"]' indexglobal="0"
          ids='["fechaSeguimientos","RubroSeguimientos","NombreSeguimientos","coordSeguimientos"]' mapa="Seguimientos"
            class="btn btn-success guardar">
            <i class="fa-solid fa-floppy-disk"></i> Guardar
          </button></div>
      </div></div>
    </div>
        
      </div>
    </div>         <div class="col-4">
      <h2>Capacitaciones </h2>
    </div>
    <div  data-sheet="Same-Capacitaciones" style="padding-bottom: 10px;">
    <div class="row  align-items-center g-2">
      <div class="d-grid gap-2 col-3 mx-auto agregar"> <button type="button" id="crearCapacitaciones"
          idIndex="selectCapacitaciones" lista='["Capacitaciones"]' indexglobal="0"
          ids='["nombreCapacitaciones","colaboracionCapacitaciones","lugarCapacitaciones","actividadCapacitaciones"]'
          class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
           Agregar</button></div>
      <div class="d-grid gap-2 col-3 mx-auto">
        <button id="quitarCapacitaciones" class="btn btn-danger" type="button"><i class="fa fa-trash" aria-hidden="true"></i> Quitar</button>
      </div>

      <div class="col-6">

      </div>
    </div>



    <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
      <div class="col-4 d-flex flex-column">
        <div class="d-grid gap-2">

        </div>
        <select class="form-select flex-grow-1 mt-3" id="selectCapacitaciones" multiple aria-label=" select example">
          <!-- Opciones -->
        </select>
      </div>
      <div class="col-8">
        <div id="DerechaCapacitaciones" style="display: none;">
        <div class="mb-3">
          <label for="nombreCapacitaciones" class="form-label">Nombre</label>
          <input type="text" class="form-control" id="nombreCapacitaciones" placeholder="Nombre" />
        </div>
        <div class="mb-3">
            <label for="nombreCapacitaciones" class="form-label">Detalles</label>
                <label for="" class="form-label"></label>
                <textarea class="form-control" name="" id="DetallesCapacitaciones" rows="3"></textarea>
         
            
        
 
        </div>
       
        <div class="mb-3">
            <label for="lugarCapacitaciones" class="form-label">Fecha</label>
            <input type="date" class="form-control" id="lugarCapacitaciones" placeholder="Nombre del lugar" />
          </div>
          <div class="mb-3">
            <label for="lugarCapacitaciones" class="form-label">Institucion</label>
            <input type="text" class="form-control" id="lugarCapacitaciones" placeholder="Nombre del lugar" />
          </div>
          <div class="mb-3">
            <label for="lugarCapacitaciones" class="form-label">Participantes</label>
            <input type="text" class="form-control" id="lugarCapacitaciones" placeholder="Nombre del lugar" />
          </div> <div class="d-grid gap-2 col-12 mx-auto "> <button type="button" idIndex="selectCapacitaciones"
            lista='["Capacitaciones"]'
            ids='["nombreCapacitaciones","colaboracionCapacitaciones","lugarCapacitaciones","actividadCapacitaciones"]'
            class="btn btn-success guardar">
            <i class="fa-solid fa-floppy-disk"></i> Guardar
          </button>
          <input type="text" class="form-control" name="CapacitacionesFinal" id="CapacitacionesFinal" style="display: none"
          aria-describedby="helpId" placeholder="" />
      </div>
      </div>
    </div>
     </div></div>
  <hr class="solid">
  
    <div class="col-4">
      <h2>Reuniones </h2>
    </div>
    <div  data-sheet="Same-Reuniones" style="padding-bottom: 10px;">
    <div class="row  align-items-center g-2">
      <div class="d-grid gap-2 col-3 mx-auto agregar"> <button type="button" id="crearParticipacion"
          idIndex="selectParticipacion" lista='["Participaciones"]' indexglobal="0"
          ids='["mes","nombreParticipacion","rubroParticipacion","totalPersonas","fechaParticipacion","lugarParticipacion","actividadParticipacion"]'
          class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
           Agregar</button></div>
      <div class="d-grid gap-2 col-3 mx-auto">
        <button id="quitarParticipacion" class="btn btn-danger" type="button"><i class="fa fa-trash" aria-hidden="true"></i> Quitar</button>
      </div>

      <div class="col-6">

      </div>
    </div>



    <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
      <div class="col-6 d-flex flex-column">
        <div class="d-grid gap-2">

        </div>
        <select class="form-select flex-grow-1 mt-3" id="selectParticipacion" multiple aria-label=" select example">
          <!-- Opciones -->
        </select>
      </div>
      <div class="col-6">
        <div id="DerechaParticipaciones" style="display: none;">
        <div class="mb-3">
          <label for="nombreParticipacion" class="form-label">Nombre</label>
          <input type="text" class="form-control" id="nombreParticipacion" placeholder="Nombre" />
        </div>
       
        <div class="mb-3">
          <label for="colaboracionParticipacion" class="form-label">Total Personas</label>
          <input type="text" class="form-control" id="totalPersonas" placeholder="Total de personas en la reunion" />
          
        </div>
        <div class="mb-3">
          <label for="colaboracionParticipacion" class="form-label">Fecha</label>
          <input type="date" class="form-control" id="fechaParticipacion" >
          
        </div>
        <div class="mb-3">
          <label for="lugarParticipacion" class="form-label">Nombre del lugar</label>
          <input type="text" class="form-control" id="lugarParticipacion" placeholder="Nombre del lugar" />
        </div>
        <div class="mb-3">
          <label for="colaboracionParticipacion" class="form-label">Rubro</label>
          <input type="text" class="form-control" id="rubroParticipacion" placeholder="Rubro de la entidad" />
          
        </div>
        <div class="mb-3">
          <label for="actividadParticipacion" class="form-label">Descripción de la actividad</label>
          <input type="text" class="form-control" id="actividadParticipacion"
            placeholder="Descripción de la actividad" />
        </div><i class="fa fa-floppy-o" aria-hidden="false"></i>
        <input type="text" class="form-control" name="ParticipacionesFinal" id="ParticipacionesFinal" style="display: none"
        aria-describedby="helpId" placeholder="" />
        <div class="d-grid gap-2 col-12 mx-auto guardar"> <button type="button" idIndex="selectParticipacion"
            lista='["Participaciones"]'
            ids='["mes","nombreParticipacion","rubroParticipacion","totalPersonas","fechaParticipacion","lugarParticipacion","actividadParticipacion"]'
            class="btn btn-success guardar"> 
            <i class="fa-solid fa-floppy-disk"></i> Guardar
          </button>
          <input type="text" class="form-control" name="ReunionesFinal" id="ReunionesFinal" style="display: none"
          aria-describedby="helpId" placeholder="" />
        </div> </div> </div> 
      </div></div>
    </div>
 
  


</div></form><button type="button" class="btn btn-block btn-primary" onclick="submitForm()">
  Submit
</button>

<div id="progressContainer" style="display: none;">
  <div class="progress">
    <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0"
      aria-valuemin="0" aria-valuemax="100"></div>
  </div>
  <p id="progressText">Enviando datos...</p>
</div>
</body>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script><script>
  async function submitForm() {
      const form = document.getElementById('mainForm');
      const progressContainer = document.getElementById('progressContainer');
      const progressBar = document.getElementById('progressBar');
      const progressText = document.getElementById('progressText');
  
      form.style.display = 'none';
      progressContainer.style.display = 'block';
  
      const sheetNames = ['Same','Same-Ferias', 'Same-Seguimientos','Same-Capacitaciones','Same-Reuniones'
      ];
      const totalSubmits = sheetNames.length;
      let completedSubmits = 0;
      const hojaCheck = ['Same-Ferias', 'Same-Seguimientos','Same-Capacitaciones','Same-Reuniones'];
      const hojaFinal = [document.getElementById('FeriasFinal').value, document.getElementById('SeguimientosFinal').value, document.getElementById('CapacitacionesFinal').value, document.getElementById('ReunionesFinal').value];
      let indexHojaCheck = 0;
      console.log(hojaFinal[1]);
      for (let index = 0; index < sheetNames.length; index++) {
          const sheetName = sheetNames[index];
          const formData = new FormData(form);  // Crear una nueva instancia de FormData por cada solicitud
          formData.set('sheetName', sheetName);
          formData.set('MultiArray', hojaFinal[indexHojaCheck]);
          formData.set('checkHojaArray', hojaCheck[indexHojaCheck]);
          console.table(formData);
          try {
              const response = await fetch('https://script.google.com/macros/s/AKfycbwmPtwWi0BTf9uW6ze7wljlHrtVrT8bHCCBb_cLB01R8N_pCvLPD07IIHDE0Qc0v7PZvA/exec', {
                  method: 'POST',
                  body: formData
              });
  
              const data = await response.json();
              console.log(data);
  
              if (sheetName == hojaCheck[indexHojaCheck]) {
                  indexHojaCheck++;
                  console.log('el numero es ' + indexHojaCheck);
              }
  
              completedSubmits++;
              const progress = Math.round((completedSubmits / totalSubmits) * 100);
              progressBar.style.width = `${progress}%`;
              progressBar.setAttribute('aria-valuenow', progress);
  
              if (completedSubmits === totalSubmits) {
                  progressText.textContent = 'Datos enviados exitosamente!';
              }
  
          } catch (error) {
              progressText.textContent = 'Error al enviar los datos.';
              console.error('Error:', error);
          }
      }
  }
  
  
  </script>
<script>
    const mapElement = document.getElementById('Feriamap');
  document.getElementById('Feria').addEventListener('click', () => {
    showMap('Feria');


    }

  );
  const SegmapElement = document.getElementById('Seguimientosmap');
  document.getElementById('crearSeguimientos').addEventListener('click', () => {
    showMap('Seguimientos');


    }

  );
  

</script>
<script src="../../../js/ListadoGenerico.js"></script>
<script src="../../../js/Economia/DesEco/Same.js"></script>
<script src="https://apis.google.com/js/api.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script type="module" src="../../../js/LeerTabla.js"></script>
</html>