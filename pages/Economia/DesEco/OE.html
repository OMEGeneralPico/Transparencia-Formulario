<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oficina de Empleo</title>
  <link rel="stylesheet" href="../../../css/estilo.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>

<body>    <div class=" justify-content-center " id="">
  <div class="row">
    <div class="nav">Hola pepe</div>
    <ul class="nav nav-tabs nav-fill">
      <li class="nav-item">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
          aria-selected="true">Home</a>
      </li>


    </ul>
    <div class="col-12 col-lg-6">
    </div>
    <div class="col-12 col-lg-6">
    </div>
  </div>
</div>
  <form
  
    id="mainForm" method="post">
    <input type="text" style="display: none;" id="mes" value="" >
    <div class="container " data-sheet="OE">
      <h2>Oficina de Empleo </h2>
      Cantidad de personas que se acercaron a la Oficina de Empleo

      <h3>Genero</h3>
      <div class="row justify-content-center align-items-center g-2">
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">Masculino</label>
            <input type="text" class="form-control form-control-lg" name="Masculino" id="" />

          </div>
        </div>
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">Femenino</label>
            <input type="text" class="form-control form-control-lg" name="Femenino" id="" />

          </div>
        </div>
      </div>
      <h3>Edad</h3>
      <div class="row justify-content-center align-items-center g-2">
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">Hasta 35</label>
            <input type="text" class="form-control form-control-lg" name="Menos35" id="" />

          </div>
        </div>
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">35 y mas</label>
            <input type="text" class="form-control form-control-lg" name="Mas35" id="" />

          </div>
        </div>
      </div>
      <h3>Cupo</h3>
      <div class="row justify-content-center align-items-center g-2">
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">Trans</label>
            <input type="text" class="form-control form-control-lg" name="Trans" id="" />

          </div>
        </div>
        <div class="col-6">
          <div class="mb-3">
            <label for="" class="form-label">Discapacidad</label>
            <input type="text" class="form-control form-control-lg" name="Disca" id="" />

          </div>
        </div>
      </div>
      <h3>Nivel Educativo</h3>
      <div class="row justify-content-center align-items-center g-2">
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Secundario Incompleto</label>
            <input type="text" class="form-control form-control-lg" name="SecIncompleto" id="" />

          </div>
        </div>
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Secundario Completo</label>
            <input type="text" class="form-control form-control-lg" name="SecCompleto" id="" />

          </div>
        </div>
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Terciario o superior</label>
            <input type="text" class="form-control form-control-lg" name="Terciario-Superior" id="" />

          </div>
        </div>
      </div>
      <h3>Situacion Laboral</h3>
      <div class="row justify-content-center align-items-center g-2">
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Trabaja/Changa</label>
            <input type="text" class="form-control form-control-lg" name="Trabajan" id="" />

          </div>
        </div>
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Desempleado con experiencia</label>
            <input type="text" class="form-control form-control-lg" name="Desempleado-C-Experiencia" id="" />

          </div>
        </div>
        <div class="col-4">
          <div class="mb-3">
            <label for="" class="form-label">Desempleado sin experiencia</label>
            <input type="text" class="form-control form-control-lg" name="Desempleado-S-Experiencia" id="" />

          </div>
        </div>
      </div><br><br>
      <h4>En relación a las empresas de la Ciudad</h4>

      <div class="row justify-content-center align-items-center g-2">
        <div class="col-12">
          <div class="mb-3">
            <label for="" class="form-label">BÚSQUEDA DE EMPRESAS REALIZADAS</label>
            <input type="text" class="form-control form-control-lg" name="Busquedas" id="" />

          </div>
        </div>

        <h2>Inserciones</h2>
        <div class="row justify-content-center align-items-center g-2">
          <div class="col-4">
            <div class="mb-3">
              <label for="" class="form-label">Total</label>
              <input type="text" class="form-control form-control-lg" name="InsercionesTotales" id="" />

            </div>
          </div>
          <div class="col-4">
            <div class="mb-3">
              <label for="" class="form-label">Cupo Trans</label>
              <input type="text" class="form-control form-control-lg" name="InsercionesTrans" id="" />

            </div>
          </div>
          <div class="col-4">
            <div class="mb-3">
              <label for="" class="form-label">Discapacidad</label>
              <input type="text" class="form-control form-control-lg" name="InsercionesDisca" id="" />

            </div>
          </div>
        </div>

        <h3>Empresas</h3>
        <div class="row justify-content-center align-items-center g-2">
          <div class="col-6">
            <div class="mb-3">
              <label for="" class="form-label">Visitadas</label>
              <input type="text" class="form-control form-control-lg" name="EmpresasVisitadas" id="" />

            </div>
          </div>
          <div class="col-6">
            <div class="mb-3">
              <label for="" class="form-label">Contactadas</label>
              <input type="text" class="form-control form-control-lg" name="EmpresasContactadas" id="" />

            </div>
          </div>
        </div>
        <div class="row justify-content-center  align-items-center g-2">
          <div class="col-12">
            <div class="mb-3">
              <label for="" class="form-label">Inscripciones</label>
              <input type="text" class="form-control form-control-lg" name="EmpresasIncripciones" id=""
                aria-describedby="helpId" placeholder="" />

            </div>
          </div>
          <div class="col-12">
            <div class="col-12">
              <div class="mb-3">
                <label for="" class="form-label">Vinculaciones</label>
                <input type="text" class="form-control form-control-lg" name="EmpresasVinculaciones" id=""
                  aria-describedby="helpId" placeholder="" />

              </div>
            </div>
          </div>
          <div class="container-md" style="padding-bottom: 10px;">
            <hr>
            <div class="col-12">
              <h2>Solicitudes</h2>
            </div>
            <div class="row  align-items-center g-2">
              <div class="d-grid gap-2 col-3 mx-auto agregar"> <button type="button" id="crearSolicitud"
                  idIndex="selectSolicitud" lista='["Solicitudes"]' indexglobal="0"
                  ids='["rubroSolicitud","puestoSolicitud","EmpresaSolicitud","EXPSolicitud"]'
                  class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
                  Agregar</button></div>
              <div class="d-grid gap-2 col-3 mx-auto">
                <button id="quitarParticipacion" class="btn btn-danger" type="button"><i class="fa fa-trash"
                    aria-hidden="true"></i> Quitar</button>
              </div>

              <div class="col-6">

              </div>
            </div>
            <nav aria-label="Page navigation">
              <ul class="pagination" id="paginasol">
              </ul>
            </nav>
            <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
              <div class="col-6 d-flex flex-column">
                <div class="d-grid gap-2">

                </div>
                <select class="form-select flex-grow-1 mt-3" id="selectSolicitud" multiple aria-label=" select example">
                  <!-- Opciones -->
                </select>
              </div>
              <div class="col-6" >
                <div id="DerechaSolicitudes" style="display: none;">
                <div class="mb-3"> <label for="rubro" class="form-label">Rubro</label>
                  <input type="text" class="form-control" id="rubroSolicitud" name="Rubro" aria-describedby="helpId"
                    placeholder="" />
                  <label for="puesto" class="form-label">Puesto</label>
                  <input type="text" class="form-control" id="puestoSolicitud" name="Puesto" aria-describedby="helpId"
                    placeholder="" />


                  <label for="empresa" class="form-label">Empresa</label>
                  <input type="text" class="form-control" id="EmpresaSolicitud" name="Empresa" aria-describedby="helpId"
                    placeholder="" />
                  <label for="experiencia" class="form-label">Experiencia</label>
                  <select class="form-select form-select-lg" id="EXPSolicitud" name="Experiencia">
                    <option selected value="">Sin experiencia</option>
                    <option value="Aprendiz / Rookie">Aprendiz / Rookie</option>
                    <option value="Novato / Junior">Novato / Junior</option>
                    <option value="Intermedio / Semi Senior">Intermedio / Semi Senior</option>
                    <option value="Experimentado / Senior">Experimentado / Senior</option>
                  </select>
                </div>
              </div>
            </div>
            </div>


          </div>
        </div>
        <div class="d-grid gap-2 col-12 mx-auto"> <button type="button" id="guardar" idIndex="selectSolicitud"
            lista='["Solicitudes"]' ids='["mes","rubroSolicitud","puestoSolicitud","EmpresaSolicitud","EXPSolicitud"]'
            class="btn btn-success guardar">
            <i class="fa-solid fa-floppy-disk"></i> Guardar
          </button></div>
      </div>

      <input type="text" class="form-control" name="SolicitudesFinal" id="SolicitudesFinal" style="display: none" value="[]"
        aria-describedby="helpId" placeholder="" />



    </div>
   
    <hr>
    <div class="container-md" data-sheet="OE-Participaciones" style="padding-bottom: 10px;">
      <div class="col-4">
        <h2>Participaciones </h2>
      </div>
      <div class="row  align-items-center g-2">
        <div class="d-grid gap-2 col-3 mx-auto agregar"> <button type="button" id="crearParticipacion"
            idIndex="selectParticipacion" lista='["Participaciones"]' indexglobal="0"
            ids='["nombreParticipacion","colaboracionParticipacion","lugarParticipacion","actividadParticipacion"]'
            class="btn btn-primary"><i class="fa fa-plus" aria-hidden="true"></i>
            Agregar</button></div>
        <div class="d-grid gap-2 col-3 mx-auto">
          <button id="quitarParticipacion" class="btn btn-danger" type="button"><i class="fa fa-trash"
              aria-hidden="true"></i> Quitar</button>
        </div>

        <div class="col-6">

        </div>
      </div>



      <div class="row justify-content-center align-items-stretch g-2" style="min-height: 9vh;">
        <div class="col-6 d-flex flex-column">
          <div class="d-grid gap-2">

          </div>
          <select class="form-select flex-grow-1 mt-3" id="selectParticipacion" multiple aria-label=" select example">
            <!-- Opciones -->
          </select>
        </div>
        <div class="col-6">
          <div id="DerechaParticipaciones" style="display: none;">
          <div class="mb-3">
            <label for="nombreParticipacion" class="form-label">Nombre</label>
            <input type="text" class="form-control" id="nombreParticipacion" name="Nombre" placeholder="Nombre" />
          </div>
          <div class="mb-3">
            <label for="colaboracionParticipacion" class="form-label">Colaboración</label>
            <input type="text" class="form-control" id="colaboracionParticipacion" name="Colaboración"
              placeholder="Colaboración" />
            <small id="helpId" class="form-text text-muted">Si se colaboró con otro organismo</small>
          </div>
          <div class="mb-3">
            <label for="lugarParticipacion" class="form-label">Nombre del lugar</label>
            <input type="text" class="form-control" id="lugarParticipacion" name="lugar"
              placeholder="Nombre del lugar" />
          </div>
          <div class="mb-3">
            <label for="actividadParticipacion" class="form-label">Descripción de la actividad</label>
            <input type="text" class="form-control" name="Descripción" id="actividadParticipacion"
              placeholder="Descripción de la actividad" />
          </div><i class="fa fa-floppy-o" aria-hidden="false"></i>
        </div>
       
        <input type="text" class="form-control" name="ParticipacionesFinal" id="ParticipacionesFinal" style="display: none"
          aria-describedby="helpId" placeholder="" />
        </div> <div class="d-grid gap-2 col-12 mx-auto"> <button type="button" idIndex="selectParticipacion"
          lista='["Participaciones"]'
          ids='["mes","nombreParticipacion","colaboracionParticipacion","lugarParticipacion","actividadParticipacion"]'
          class="btn btn-success guardar">
          <i class="fa-solid fa-floppy-disk"></i> Guardar
        </button></div>
      </div>
    </div>
    </div>
    <button type="button" class="btn btn-block btn-primary" onclick="submitForm()">
      Submit
    </button>
  </form>
  <div id="progressContainer" style="display: none;">
    <div class="progress">
      <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0"
        aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <p id="progressText">Enviando datos...</p>
  </div>
</body>
<script>
async function submitForm() {
    const form = document.getElementById('mainForm');
    const progressContainer = document.getElementById('progressContainer');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');

    form.style.display = 'none';
    progressContainer.style.display = 'block';

    const sheetNames = ['OE','OE-Participaciones', 'OE-Solicitudes'];
    const totalSubmits = sheetNames.length;
    let completedSubmits = 0;
    const hojaCheck = ['OE-Participaciones', 'OE-Solicitudes'];
    const hojaFinal = [document.getElementById('ParticipacionesFinal').value, document.getElementById('SolicitudesFinal').value];
    let indexHojaCheck = 0;

    for (let index = 0; index < sheetNames.length; index++) {
        const sheetName = sheetNames[index];
        const formData = new FormData(form);  // Crear una nueva instancia de FormData por cada solicitud
        formData.set('sheetName', sheetName);
        formData.set('MultiArray', hojaFinal[indexHojaCheck]);
        formData.set('checkHojaArray', hojaCheck[indexHojaCheck]);

        try {
            const response = await fetch('https://script.google.com/macros/s/AKfycbwmPtwWi0BTf9uW6ze7wljlHrtVrT8bHCCBb_cLB01R8N_pCvLPD07IIHDE0Qc0v7PZvA/exec', {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            console.log(data);

            if (sheetName == hojaCheck[indexHojaCheck]) {
                indexHojaCheck++;
                console.log('el numero es ' + indexHojaCheck);
            }

            completedSubmits++;
            const progress = Math.round((completedSubmits / totalSubmits) * 100);
            progressBar.style.width = `${progress}%`;
            progressBar.setAttribute('aria-valuenow', progress);

            if (completedSubmits === totalSubmits) {
                progressText.textContent = 'Datos enviados exitosamente!';
            }

        } catch (error) {
            progressText.textContent = 'Error al enviar los datos.';
            console.error('Error:', error);
        }
    }
}


</script>
<script>
  const mesInput = document.getElementById('mes');
const fecha = new Date();
const numeroMes = fecha.getMonth() + 1; // Obtener el número del mes (0-11, enero-diciembre)
mesInput.value = numeroMes;
</script>
<script src="../../../js/ListadoGenerico.js"></script>
<script src="https://apis.google.com/js/api.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script type="module" src="../../../js/LeerTabla.js"></script>

</html>